<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DATSPACE</title>
<style>
html, body {
    margin:0;
    padding:0;
    background:black;
    color:white;
    font-family:Consolas, monospace;
    overflow:hidden;
}

canvas {
    position:fixed;
    top:0;
    left:0;
}

.tabs {
    position:fixed;
    top:40px;
    right:80px;
    font-size:18px;
    z-index:10;
}

.tab {
    margin-left:30px;
    cursor:pointer;
    display:inline-block;
}

.active {
    border:1px solid white;
    padding:6px 12px;
}

.content {
    position:fixed;
    bottom:120px;
    left:50%;
    transform:translateX(-50%);
    font-size:24px;
    text-align:center;
    z-index:10;
    max-width:90%;
}
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<div class="tabs">
    <span class="tab active">HOME</span>
    <span class="tab">EVENT</span>
    <span class="tab">LOCATION</span>
    <span class="tab">PROGRAM</span>
    <span class="tab">CONTACT</span>
</div>

<div class="content" id="content">//DATSPACE</div>

<script>

// ==========================
// CANVAS FULLSCREEN FIX
// ==========================

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    const dpr = window.devicePixelRatio || 1;

    canvas.style.width = window.innerWidth + "px";
    canvas.style.height = window.innerHeight + "px";

    canvas.width = window.innerWidth * dpr;
    canvas.height = window.innerHeight * dpr;

    ctx.setTransform(1,0,0,1,0,0);
    ctx.scale(dpr, dpr);
}

window.addEventListener("resize", resizeCanvas);
resizeCanvas();


// ==========================
// STATE
// ==========================

let dragging = false;
let glitchFrames = 0;
let frequency = 300;
let volume = 0.05;
let currentTab = "HOME";

const tabs = document.querySelectorAll(".tab");
const content = document.getElementById("content");

tabs.forEach(tab=>{
    tab.addEventListener("click",()=>{
        tabs.forEach(t=>t.classList.remove("active"));
        tab.classList.add("active");
        currentTab = tab.innerText;
        updateContent();
        glitchFrames = 12;
        triggerSound();
    });
});

function updateContent(){
    if(currentTab==="HOME") {
        content.innerHTML = "//DATSPACE";
    }
    if(currentTab==="EVENT") {
        // Embed Instagram
        content.innerHTML = `
            <blockquote class="instagram-media" 
                data-instgrm-permalink="https://www.instagram.com/p/DUh0t-7AWl9/?igsh=MWU0eTJ4amwzNmRjdg==" 
                data-instgrm-version="14" 
                style="width:100%; max-width:600px; margin:auto;">
            </blockquote>`;
        
        // Load Instagram embed script if not already loaded
        if(!document.getElementById("insta-script")) {
            const script = document.createElement("script");
            script.src = "https://www.instagram.com/embed.js";
            script.async = true;
            script.id = "insta-script";
            document.body.appendChild(script);
        } else {
            // Re-initialize embed jika script sudah ada
            window.instgrm?.Embeds?.process();
        }
    }
    if(currentTab==="LOCATION") content.innerText="Jalan Gatsu Timur No.88X, Denpasar, Bali, Indonesia";
    if(currentTab==="PROGRAM") content.innerText="DatIn — Indoor AV / DatOut — Outdoor AV";
    if(currentTab==="CONTACT") content.innerText="info@datspace.club";
}


// ==========================
// MOUSE INTERACTION
// ==========================

canvas.addEventListener("mousedown",()=>{
    dragging = true;
    glitchFrames = 12;
    triggerSound();
});

canvas.addEventListener("mouseup",()=> dragging=false);

canvas.addEventListener("mousemove",(e)=>{
    frequency = 100 + (e.clientX/window.innerWidth)*1200;
    let yNorm = 1 - (e.clientY/window.innerHeight);
    volume = Math.pow(yNorm,2.2)*0.5;
});


// ==========================
// DRAW LOOP
// ==========================

function draw(){

    ctx.fillStyle="black";
    ctx.fillRect(0,0,window.innerWidth,window.innerHeight);

    // TITLE
    if(currentTab!=="EVENT"){
        ctx.fillStyle="white";
        ctx.textAlign="center";
        ctx.font = Math.min(window.innerWidth/6, 180) + "px Consolas";
        ctx.fillText("DATs", window.innerWidth/2, window.innerHeight/2);
    }

    // DRAG VISUAL
    if(dragging){
        ctx.strokeStyle="white";
        for(let r=50;r<Math.min(window.innerWidth, window.innerHeight)/1.2;r+=40){
            let offset = Math.sin(Date.now()*0.002 + r*0.05)*20;
            ctx.beginPath();
            ctx.arc(
                window.innerWidth/2 + offset,
                window.innerHeight/2,
                r,
                0,
                Math.PI*2
            );
            ctx.stroke();
        }
    }

    // GLITCH
    if(glitchFrames>0){
        for(let i=0;i<120;i++){
            ctx.fillStyle=Math.random()>0.5?"white":"black";
            ctx.fillRect(
                Math.random()*window.innerWidth,
                Math.random()*window.innerHeight,
                Math.random()*400,
                Math.random()*80
            );
        }
        glitchFrames--;
    }

    requestAnimationFrame(draw);
}

draw();


// ==========================
// AUDIO ENGINE (WebAudio)
// ==========================

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function triggerSound(){

    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    const delay = audioCtx.createDelay();
    const feedbackGain = audioCtx.createGain();

    osc.type="sine";
    osc.frequency.value = frequency;

    gain.gain.value = volume;

    delay.delayTime.value = 0.3;
    feedbackGain.gain.value = 0.4;

    osc.connect(gain);
    gain.connect(delay);
    delay.connect(feedbackGain);
    feedbackGain.connect(delay);
    delay.connect(audioCtx.destination);
    gain.connect(audioCtx.destination);

    osc.start();
    osc.stop(audioCtx.currentTime + 0.35);
}


// ==========================
// DOUBLE CLICK FULLSCREEN
// ==========================

canvas.addEventListener("dblclick", ()=>{
    if (!document.fullscreenElement) {
        document.body.requestFullscreen();
    } else {
        document.exitFullscreen();
    }
});

</script>
</body>
</html>




